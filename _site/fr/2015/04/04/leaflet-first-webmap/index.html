




<!DOCTYPE html>
<html>

    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="assets/ico/favicon.ico">

    <title>MaptimeAlpes - Créer une carte avec leaflet</title>

    <!-- Custom styles for this template -->
    <link href="/assets/css/style.css" rel="stylesheet">
    <link href="/assets/css/fontcustom/fontcustom.css" rel="stylesheet">
    
    <link href="/assets/css/prism.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="/assets/js/modernizr.js"></script>
    <script src="/assets/js/prism.js"></script>
</head>

    <body>
        




<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">

      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
        <svg version="1.1" id="mt_pin" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">
<g>
	<g>
		<path fill="#231F20" d="M379.4,54.2c43.4,32.5,80.4,131.1,50,207.9c-10.8,27.2-29,45-44.1,68.6c-24.8,38.8-53.4,78.8-82.4,116.7
			c-15,17.3-30.1,34.6-45.1,52c-0.7,0-1.3,0-2,0c-25-18.9-43-50.2-61.8-75.5c-39.9-53.7-92-111.1-115.7-179.4
			c-5.8-16.8-6.2-81.4,0-98c7.7-20.8,15.4-42.2,26.5-59.8c15.6-24.8,45.5-48.1,75.5-60.8c15.4-3.9,30.7-7.8,46.1-11.8
			c24.8-0.2,58.4-4.4,78.4,2.9C333.3,27.4,357.6,37.8,379.4,54.2z M373.5,232.6C408.6,144,336.1,70.9,252.9,68.9
			c-12.4,2.3-24.8,4.6-37.3,6.9c-34.6,11.9-62.8,37.7-76.5,70.6c-33.5,80.5,47.4,181.6,136.3,160.8
			C321.2,296.4,357.6,272.7,373.5,232.6z"/>
	</g>
	<g>
		<path fill="#231F20" d="M268.6,160.1c17.7,12.1,40.4,40,11.8,59.8c-6.1,4.2-12.8,1.3-20.6,4.9c-10.8,15.4-21.6,30.7-32.4,46.1
			c-4.2,0-8.5,0-12.7,0c4-23.3,18.5-31.4,26.5-51c-15.4-19.3-15.5-48.9,10.8-57.8c4.7-10.1,2.2-32.4,2-46.1
			c1.6-1.3,3.3-2.6,4.9-3.9c1.6,0,3.3,0,4.9,0C270,121.4,267.6,146,268.6,160.1z"/>
	</g>
</g>
</svg>

        <span>Maptime Alpes!</span>
      </a>
    </div>

    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        
        <li>
          <a href="/">Accueil</a>
        </li>
        
        <li>
          <a href="/fr/blog/">Blog</a>
        </li>
        
        <li>
          <a href="/fr/ateliers/">Ateliers</a>
        </li>
        
        <li>
          <a href="/fr/apropos/">À propos</a>
        </li>
        
        <li>
          <a href="http://www.maptime.io">Maptime.io</a>
        </li>
        
        <li><div class="locale-links">
          
            
              <a href="/"><img class="flag" src="/assets/img/fr.png"/>
            
              </a>
          
            
              <a href="/en"><img class="flag" src="/assets/img/us.png"/>
            
              </a>
          
        </div></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>


            




<div id="miniheaderwrap" class='tut'>
    <div class="mini-map-banner">
    	<div class="container">
        	<div class="pull-left mini-text-block">
            	<h3 id="page-title" class="pull-left">Créer une carte avec leaflet</h3>
            </div>
        </div>
    </div>
</div>



<div class="tutorial container" id="tutorial">
  	<p>Cet article fait suite à la <a href="http://maptime-alpes.com/leaflet-first-webmap/">présentation</a> “Débuter avec Leaflet” lors du Meet-Up <a href="http://maptime-alpes.com">Maptime-Alpes</a> de février.
<!--more--></p>

<p>Nous allons donc créer une webmap avec <a href="http://leafletjs.com">leaflet</a>.</p>

<p>Tout d’abord nous allons inclure la librairie et sa feuille de style:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;//cdn.leafletjs.com/leaflet-0.7.3/leaflet.css&quot;</span> <span class="o">/&gt;</span>

<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;//cdn.leafletjs.com/leaflet-0.7.3/leaflet.js&quot;</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="err">/script&gt;</span></code></pre></div>

<p>L’ajout de la carte s’effectue avec la simple syntaxe suivante:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;leaflet-map&#39;</span><span class="p">).</span><span class="nx">setView</span><span class="p">([</span><span class="mf">45.18</span><span class="p">,</span> <span class="mf">5.72</span><span class="p">],</span> <span class="mi">13</span><span class="p">);</span></code></pre></div>

<p>la carte est centrée sur les coordonnées Latitude 45.18 N et Longitude 5.72 E. Des coordonnées positives indiquent des coordonées Nord et Est, les coordonées sont négatives au Sud et à l’Ouest.</p>

<p>Ajoutons maintenant un fond de plan, il s’agit d’une carte dont les tuiles (images de 256x256 ont été calculées) sont hébergées sur un serveur:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png&#39;</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span></code></pre></div>

<p>Nous utilisons ici une fond de plan d’une startup de San Franciso dont le style est original.</p>

<p>Précisions maintenant les atributs particuliers de notre URL:
- {s} représente les sous domaines, il s’agit de redondances des serveurs, les images sont copiées sur différents serveurs pour répartir la charge.
- {z} niveau d’échelle des tuiles
- {x} et {y} sont, bien sûr, l’abscisse et l’ordonnée.
Ces infomrations sont décrites dans la <a href="http://maptime-alpes.com/leaflet-first-webmap/">présentation</a>.</p>

<p>L’ajout d’un marqueur à l’adresse de CoWork in Grenoble où nous sommes ce soir s’effectue ainsi:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.19129</span><span class="p">,</span> <span class="mf">5.73332</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s2">&quot;Cowork In Grenoble&quot;</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span></code></pre></div>

<p>Et voici le résultat</p>

<p><a class="jsbin-embed" href="http://jsbin.com/dezopu/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<p>Maintenant passons au deuxième exercice. Pour commencer nous ajoutons plus de marqueurs, mais au lieu de les ajouter à la carte directmenet, nous les ajoutons à un groupe <code>LayerGroup</code>, ainsi ce groupe ajouté à un Control permet de changer l’affichage à l’aide de case à cocher, permettant ainsi d’afficher ou masquer des couches de la carte.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">poi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LayerGroup</span><span class="p">();</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.17447</span><span class="p">,</span> <span class="mf">5.54346</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">&#39;Autrans&#39;</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">cities</span><span class="p">);</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.22201</span><span class="p">,</span> <span class="mf">5.8037</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">&#39;Montbonnot Saint-Martin&#39;</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">cities</span><span class="p">);</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.0781</span><span class="p">,</span> <span class="mf">5.77078</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">&#39;Vizille&#39;</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">cities</span><span class="p">);</span></code></pre></div>

<p>Enfin nous allons aussi ajouter la possiblité de changer de fond de plan</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">mbAttr</span> <span class="o">=</span> <span class="s1">&#39;Map data &amp;copy; &lt;a href=&quot;http://openstreetmap.org&quot;&gt;OpenStreetMap&lt;/a&gt; contributors, &lt;a href=&quot;http://creativecommons.org/licenses/by-sa/2.0/&quot;&gt;CC-BY-SA&lt;/a&gt;, Imagery © &lt;a href=&quot;http://mapbox.com&quot;&gt;Mapbox&lt;/a&gt;&#39;</span><span class="p">,</span>
      <span class="nx">mbUrl</span> <span class="o">=</span> <span class="s1">&#39;https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">grayscale</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="nx">mbUrl</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;examples.map-20v6611k&#39;</span><span class="p">,</span>
        <span class="nx">attribution</span><span class="o">:</span> <span class="nx">mbAttr</span>
      <span class="p">}),</span>
      <span class="nx">streets</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="nx">mbUrl</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;examples.map-i875mjb7&#39;</span><span class="p">,</span>
        <span class="nx">attribution</span><span class="o">:</span> <span class="nx">mbAttr</span>
      <span class="p">}),</span>
      <span class="nx">imagery</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}&#39;</span><span class="p">),</span>
      <span class="nx">toner</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png&#39;</span><span class="p">),</span>
      <span class="nx">space</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://{s}.tiles.mapbox.com/v3/eleanor.ipncow29/{z}/{x}/{y}.png&#39;</span><span class="p">);</span></code></pre></div>

<p>Et pour finir modifions la carte, et ajoutons lui les groupes et les fonds de plans:</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;leaflet-map&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">center</span><span class="o">:</span> <span class="p">[</span><span class="mf">45.19129</span><span class="p">,</span> <span class="mf">5.73332</span><span class="p">],</span>
      <span class="nx">zoom</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span><span class="nx">grayscale</span><span class="p">,</span> <span class="nx">poi</span><span class="p">]</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;Grayscale&quot;</span><span class="o">:</span> <span class="nx">grayscale</span><span class="p">,</span>
      <span class="s2">&quot;Streets&quot;</span><span class="o">:</span> <span class="nx">streets</span><span class="p">,</span>
      <span class="s2">&quot;Stamen Toner&quot;</span><span class="o">:</span> <span class="nx">toner</span><span class="p">,</span>
      <span class="s2">&quot;esri imagery&quot;</span><span class="o">:</span> <span class="nx">imagery</span><span class="p">,</span>
      <span class="s2">&quot;MapBox space&quot;</span><span class="o">:</span> <span class="nx">space</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;POI&quot;</span><span class="o">:</span> <span class="nx">poi</span>
    <span class="p">};</span>

    <span class="nx">L</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">layers</span><span class="p">(</span><span class="nx">baseLayers</span><span class="p">,</span> <span class="nx">overlays</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span></code></pre></div>

<p>Cela donne cela:</p>

<p><a class="jsbin-embed" href="http://jsbin.com/cemimo/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<p>Notre premiere carte est plutôt jolie !</p>

<h2 id="challenges">Challenges</h2>

<h3 id="dlits">Délits</h3>
<p>nous allons réaliser une carte des délist sur San Francisco, pour cela nous utilisons le service <a href="http://sanfrancisco.crimespotting.org/crime-data?format=json&amp;count=1000&amp;dstart=2014-12-01">sanfrancisco.crimespotting</a> retournant des données au format geojson; </p>

<p><a class="jsbin-embed" href="http://jsbin.com/xiwiqa/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<h3 id="seismes">Seismes</h3>
<p>nous passons à l’étape supérieur en réalisant une carte des seisme récent. pour cela nous disposns du service <a href="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson">USGS</a> retournant les données aux format geojson. L’affichage de tous les points n’étant pas lisible, nous utilisons cette fois la carte de chaleur, ainsi la concentration des points indique les zones où le nombre de trembelement de terre est  impsrtant.</p>

<p><a class="jsbin-embed" href="http://jsbin.com/jolego/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

</div>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script>
  $(document).ready(function(){
	  
	  // sticky header with generated ids and anchors for <h1> tags
	  var title = $("#page-title");
	  title.after($("<div class='pull-left tutorial-navs'><ul id='tutorial-nav'></ul></div>"));

	  var heads = document.getElementsByTagName("h1");
	  var tutNav = document.getElementById("tutorial-nav");
	  for (var i=0; i<heads.length; i++) {
	    if(heads[i].className!="tutorial-title") {
	      var text = heads[i].innerHTML;
	      var target = nice(text);

	      // create list item and anchor
	      var item = document.createElement("li");
	      var anchor = document.createElement("a");
	      anchor.href = "#"+target;
	      anchor.innerHTML = text;
	      item.appendChild(anchor);
	      tutNav.appendChild(item);

	      // add id to h1 element in page
	      heads[i].id = target;

	    }
	  }

	  // collapse sections
	  $(".collapse-button").on("click", function(){
	    $(this).next(".collapse").slideToggle(200);
	  });

	  // click navigation anchors and animate scroll
	  $('a').on('click', function(){
	    if($(this).attr('href').indexOf('#')>-1) {
	      event.preventDefault();
	      var id = $(this).attr("href");
	      var top = $(id).offset().top - 160;
	      $("html, body").animate({
	        scrollTop: top
	      }, 500); // you can set any time here
	    }
	  });

	  var nav = $("#tutorial-nav");
	  $("#tutorial-nav li:eq(0) a").addClass('nav-active');
	  var aChildren = $("#tutorial-nav li").children();
	  var aArray = [];
	  var top = nav.offset().top;

	  for (var i=0; i < aChildren.length; i++) {    
	      var aChild = aChildren[i];
	      var ahref = $(aChild).attr('href');
	      aArray.push(ahref);
	  }

	});

	function nice(str) {
	  var newString = str.replace(/[^A-Z0-9]+/ig, "-").toLowerCase();
	  return newString;
	}
</script>

        




<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <h4>À propos</h4>
                <div class="hline-w"></div>
                <p>We make maps in the Alps. On fait de la cartographie dans les Alpes!</p>
            </div>
            <div class="col-sm-6">
                





  


<h4>Réseaux sociaux</h4>
<div class="hline-w"></div>
<p>
    
        <a href="https://twitter.com/MaptimeAlpes" class="btn-social btn-outline"><i class="icon-twitter"></i></a>
    
        <a href="https://github.com/MaptimeAlpes" class="btn-social btn-outline"><i class="icon-github"></i></a>
    
        <a href="http://www.meetup.com/MaptimeAlpes/" class="btn-social btn-outline"><i class="icon-meetup"></i></a>
    
</p>
            </div>
        </div>
    </div>
</div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>





<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55615382-1', 'auto');
  ga('send', 'pageview');

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-55615382-1']);

	// set custom variables
	_gaq.push(['_setCustomVar',
      1,
      'Locale',
      'fr',
      3                    // Sets the scope to page-level.  Optional parameter.
   ]);

	// track page view
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
<script>
!function(d,s,id){
	var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s); js.id=id;js.async=true;js.src="https://a248.e.akamai.net/secure.meetupstatic.com/s/script/541522619002077648/api/mu.btns.js?id=7mne7asu2b3mogbtcckibuio6d";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","mu-bootjs");
// put anchor snippet in post
//<a href="http://www.meetup.com/MaptimeAlpes/events/222341190/" data-event="222341190" class="mu-rsvp-btn">RSVP</a>
</script>
    </body>
</html>