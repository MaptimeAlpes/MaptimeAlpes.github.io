

<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="We make maps in the Alps. On fait de la cartographie dans les Alpes!">
    <meta name="author" content="Maptime-Alpes Contributors">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/assets/img/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/img/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/img/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/img/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/assets/img/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/img/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png" />
    <link rel="icon" type="image/png" href="/assets/img/favicon-16x16.png" />
    <meta name="application-name" content="Maptime-Alpes"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/assets/img/mstile-144x144.png" />

    <title>MaptimeAlpes - Créer une carte avec leaflet</title>

    <!-- Custom styles for this template -->
    <link href="/assets/css/style.css" rel="stylesheet">
    <link href="/assets/css/fontcustom/fontcustom.css" rel="stylesheet">
    
    <link href="/assets/css/prism.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="/assets/js/modernizr.js"></script>
    <script src="/assets/js/prism.js"></script>
</head>

    <body>
        

<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">

      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
        <svg id="mt_pin" viewBox="0 0 29 41" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M12.7656702,16.506016 C13.1349844,16.6854737 13.5496704,16.7861333 13.9878667,16.7861333 C15.534264,16.7861333 16.7878667,15.5325306 16.7878667,13.9861333 C16.7878667,12.7669958 16.0087129,11.7298393 14.9212,11.3454587 L14.9212,5.58613333 L13.9878667,4.6528 L13.0545333,5.58613333 L13.0545333,11.3454587 C11.9670205,11.7298393 11.1878667,12.7669958 11.1878667,13.9861333 C11.1878667,14.4124673 11.2831501,14.8165465 11.4535834,15.1782375 L8.29929023,18.3325306 L8.29929023,19.6524633 L9.61922289,19.6524633 L12.7656702,16.506016 Z M14.0160043,0.016 C17.8989916,0.016 21.2027378,1.37751175 23.9272427,4.10053526 C26.6517476,6.82355876 28.014,10.1255085 28.014,14.0063846 C28.014,15.9468226 27.5282925,18.1690449 26.5568776,20.6730513 C25.5854627,23.1770577 24.4109458,25.5248141 23.0333271,27.7163205 C21.6557084,29.9078269 20.293456,31.9577735 18.9465698,33.8661603 C17.5996836,35.774547 16.4565674,37.2923088 15.5172212,38.4194455 L14.014,40.016 C13.6385288,39.5779658 13.137455,38.9990395 12.5107788,38.2792212 C11.8841026,37.5594028 10.7563527,36.119766 9.12752899,33.9603109 C7.49870532,31.8008558 6.07365163,29.7035 4.85236793,27.6682436 C3.63108423,25.6329872 2.51936865,23.33264 1.51722119,20.7672019 C0.515073729,18.2017639 0.014,15.9481581 0.014,14.0063846 C0.014,10.1255085 1.37625245,6.82355876 4.10075734,4.10053526 C6.82526223,1.37751175 10.1290084,0.016 14.0119957,0.016 L14.0160043,0.016 Z M13.9878667,24.2528 C19.6579901,24.2528 24.2545333,19.6562568 24.2545333,13.9861333 C24.2545333,8.3160099 19.6579901,3.71946667 13.9878667,3.71946667 C8.31774324,3.71946667 3.7212,8.3160099 3.7212,13.9861333 C3.7212,19.6562568 8.31774324,24.2528 13.9878667,24.2528 Z" id="Shape" fill="#231F20"></path>
    </g>
</svg>

        <span>Maptime Alpes!</span>
      </a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        
        <li>
          <a href="/">Accueil</a>
        </li>
        
        <li>
          <a href="/fr/blog/">Blog</a>
        </li>
        
        <li>
          <a href="/fr/ateliers/">Ateliers</a>
        </li>
        
        <li>
          <a href="/fr/apropos/">À propos</a>
        </li>
        
        <li>
          <a href="http://www.maptime.io">Maptime.io</a>
        </li>
        
        <li><div class="locale-links">
          
            
              <a href="/"><img class="flag" src="/assets/img/fr.png"/>
            
              </a>
          
            
              <a href="/en"><img class="flag" src="/assets/img/us.png"/>
            
              </a>
          
        </div></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>

        

<div id="miniheaderwrap" class='tut'>
    <div class="mini-map-banner">
    	<div class="container">
        	<div class="pull-left mini-text-block">
            	<h3 id="page-title" class="pull-left">Créer une carte avec leaflet</h3>
            </div>
        </div>
    </div>
</div>

<div class="tutorial container" id="tutorial">
<p>Cet article fait suite à la <a href="http://maptime-alpes.com/leaflet-first-webmap/">présentation</a> “Débuter avec Leaflet” lors du Meet-Up <a href="http://maptime-alpes.com">Maptime-Alpes</a> de février.
<!--more--></p>

<p>Nous allons donc créer une webmap avec <a href="http://leafletjs.com">leaflet</a>.</p>

<p>Tout d’abord nous allons inclure la librairie et sa feuille de style:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"//cdn.leafletjs.com/leaflet-0.7.3/leaflet.css"</span> <span class="o">/&gt;</span>

<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"//cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="sr">/script&gt;</span></code></pre></figure>

<p>L’ajout de la carte s’effectue avec la simple syntaxe suivante:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">'leaflet-map'</span><span class="p">).</span><span class="nx">setView</span><span class="p">([</span><span class="mf">45.18</span><span class="p">,</span> <span class="mf">5.72</span><span class="p">],</span> <span class="mi">13</span><span class="p">);</span></code></pre></figure>

<p>la carte est centrée sur les coordonnées Latitude 45.18 N et Longitude 5.72 E. Des coordonnées positives indiquent des coordonées Nord et Est, les coordonées sont négatives au Sud et à l’Ouest.</p>

<p>Ajoutons maintenant un fond de plan, il s’agit d’une carte dont les tuiles (images de 256x256 ont été calculées) sont hébergées sur un serveur:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">'http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png'</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span></code></pre></figure>

<p>Nous utilisons ici une fond de plan d’une startup de San Franciso dont le style est original.</p>

<p>Précisions maintenant les atributs particuliers de notre URL:
- {s} représente les sous domaines, il s’agit de redondances des serveurs, les images sont copiées sur différents serveurs pour répartir la charge.
- {z} niveau d’échelle des tuiles
- {x} et {y} sont, bien sûr, l’abscisse et l’ordonnée.
Ces infomrations sont décrites dans la <a href="http://maptime-alpes.com/leaflet-first-webmap/">présentation</a>.</p>

<p>L’ajout d’un marqueur à l’adresse de CoWork in Grenoble où nous sommes ce soir s’effectue ainsi:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.19129</span><span class="p">,</span> <span class="mf">5.73332</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s2">"Cowork In Grenoble"</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span></code></pre></figure>

<p>Et voici le résultat</p>

<p><a class="jsbin-embed" href="http://jsbin.com/dezopu/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<p>Maintenant passons au deuxième exercice. Pour commencer nous ajoutons plus de marqueurs, mais au lieu de les ajouter à la carte directmenet, nous les ajoutons à un groupe <code class="highlighter-rouge">LayerGroup</code>, ainsi ce groupe ajouté à un Control permet de changer l’affichage à l’aide de case à cocher, permettant ainsi d’afficher ou masquer des couches de la carte.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">poi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LayerGroup</span><span class="p">();</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.17447</span><span class="p">,</span> <span class="mf">5.54346</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">'Autrans'</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">cities</span><span class="p">);</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.22201</span><span class="p">,</span> <span class="mf">5.8037</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">'Montbonnot Saint-Martin'</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">cities</span><span class="p">);</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">45.0781</span><span class="p">,</span> <span class="mf">5.77078</span><span class="p">]).</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s1">'Vizille'</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">cities</span><span class="p">);</span></code></pre></figure>

<p>Enfin nous allons aussi ajouter la possiblité de changer de fond de plan</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">mbAttr</span> <span class="o">=</span> <span class="s1">'Map data &amp;copy; &lt;a href="http://openstreetmap.org"&gt;OpenStreetMap&lt;/a&gt; contributors, &lt;a href="http://creativecommons.org/licenses/by-sa/2.0/"&gt;CC-BY-SA&lt;/a&gt;, Imagery © &lt;a href="http://mapbox.com"&gt;Mapbox&lt;/a&gt;'</span><span class="p">,</span>
      <span class="nx">mbUrl</span> <span class="o">=</span> <span class="s1">'https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">grayscale</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="nx">mbUrl</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="s1">'examples.map-20v6611k'</span><span class="p">,</span>
        <span class="na">attribution</span><span class="p">:</span> <span class="nx">mbAttr</span>
      <span class="p">}),</span>
      <span class="nx">streets</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="nx">mbUrl</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="s1">'examples.map-i875mjb7'</span><span class="p">,</span>
        <span class="na">attribution</span><span class="p">:</span> <span class="nx">mbAttr</span>
      <span class="p">}),</span>
      <span class="nx">imagery</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'</span><span class="p">),</span>
      <span class="nx">toner</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">'http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png'</span><span class="p">),</span>
      <span class="nx">space</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">'http://{s}.tiles.mapbox.com/v3/eleanor.ipncow29/{z}/{x}/{y}.png'</span><span class="p">);</span></code></pre></figure>

<p>Et pour finir modifions la carte, et ajoutons lui les groupes et les fonds de plans:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">    <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">'leaflet-map'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">center</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.19129</span><span class="p">,</span> <span class="mf">5.73332</span><span class="p">],</span>
      <span class="na">zoom</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="na">layers</span><span class="p">:</span> <span class="p">[</span><span class="nx">grayscale</span><span class="p">,</span> <span class="nx">poi</span><span class="p">]</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">"Grayscale"</span><span class="p">:</span> <span class="nx">grayscale</span><span class="p">,</span>
      <span class="s2">"Streets"</span><span class="p">:</span> <span class="nx">streets</span><span class="p">,</span>
      <span class="s2">"Stamen Toner"</span><span class="p">:</span> <span class="nx">toner</span><span class="p">,</span>
      <span class="s2">"esri imagery"</span><span class="p">:</span> <span class="nx">imagery</span><span class="p">,</span>
      <span class="s2">"MapBox space"</span><span class="p">:</span> <span class="nx">space</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">"POI"</span><span class="p">:</span> <span class="nx">poi</span>
    <span class="p">};</span>

    <span class="nx">L</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">layers</span><span class="p">(</span><span class="nx">baseLayers</span><span class="p">,</span> <span class="nx">overlays</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span></code></pre></figure>

<p>Cela donne cela:</p>

<p><a class="jsbin-embed" href="http://jsbin.com/cemimo/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<p>Notre premiere carte est plutôt jolie !</p>

<h2 id="challenges">Challenges</h2>

<h3 id="dlits">Délits</h3>
<p>nous allons réaliser une carte des délist sur San Francisco, pour cela nous utilisons le service <a href="http://sanfrancisco.crimespotting.org/crime-data?format=json&amp;count=1000&amp;dstart=2014-12-01">sanfrancisco.crimespotting</a> retournant des données au format geojson;</p>

<p><a class="jsbin-embed" href="http://jsbin.com/xiwiqa/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

<h3 id="seismes">Seismes</h3>
<p>nous passons à l’étape supérieur en réalisant une carte des seisme récent. pour cela nous disposns du service <a href="http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson">USGS</a> retournant les données aux format geojson. L’affichage de tous les points n’étant pas lisible, nous utilisons cette fois la carte de chaleur, ainsi la concentration des points indique les zones où le nombre de trembelement de terre est  impsrtant.</p>

<p><a class="jsbin-embed" href="http://jsbin.com/jolego/embed?output">JS Bin</a><script src="http://static.jsbin.com/js/embed.js"></script></p>

</div>
<script src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
<script>
  $(document).ready(function(){
	  // sticky header with generated ids and anchors for <h1> tags
	  var title = $("#page-title");
	  title.after($("<div class='pull-left tutorial-navs'><ul id='tutorial-nav'></ul></div>"));

	  var heads = document.getElementsByTagName("h1");
	  var tutNav = document.getElementById("tutorial-nav");
	  for (var i=0; i<heads.length; i++) {
	    if(heads[i].className!="tutorial-title") {
	      var text = heads[i].innerHTML;
	      var target = nice(text);

	      // create list item and anchor
	      var item = document.createElement("li");
	      var anchor = document.createElement("a");
	      anchor.href = "#"+target;
	      anchor.innerHTML = text;
	      item.appendChild(anchor);
	      tutNav.appendChild(item);

	      // add id to h1 element in page
	      heads[i].id = target;
	    }
	  }

	  // collapse sections
	  $(".collapse-button").on("click", function(){
	    $(this).next(".collapse").slideToggle(200);
	  });

	  // click navigation anchors and animate scroll
	  $('a').on('click', function(){
	    if($(this).attr('href').indexOf('#')>-1) {
	      event.preventDefault();
	      var id = $(this).attr("href");
	      var top = $(id).offset().top - 160;
	      $("html, body").animate({
	        scrollTop: top
	      }, 500); // you can set any time here
	    }
	  });

	  var nav = $("#tutorial-nav");
	  $("#tutorial-nav li:eq(0) a").addClass('nav-active');
	  var aChildren = $("#tutorial-nav li").children();
	  var aArray = [];
	  var top = nav.offset().top;

	  for (var i=0; i < aChildren.length; i++) {
	      var aChild = aChildren[i];
	      var ahref = $(aChild).attr('href');
	      aArray.push(ahref);
	  }

	});

	function nice(str) {
	  var newString = str.replace(/[^A-Z0-9]+/ig, "-").toLowerCase();
	  return newString;
	}
</script>


        

<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <h4>À propos</h4>
                <div class="hline-w"></div>
                <p>We make maps in the Alps. On fait de la cartographie dans les Alpes!</p>
            </div>
            <div class="col-sm-6">
            




<h4>Réseaux sociaux</h4>
<div class="hline-w"></div>
<p>
    
        <a href="https://twitter.com/MaptimeAlpes" class="btn-social btn-outline"><i class="icon-twitter"></i></a>
    
        <a href="https://github.com/MaptimeAlpes" class="btn-social btn-outline"><i class="icon-github"></i></a>
    
        <a href="http://www.meetup.com/MaptimeAlpes/" class="btn-social btn-outline"><i class="icon-meetup"></i></a>
    
</p>
            </div>
        </div>
    </div>
</div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55615382-1', 'auto');
  ga('send', 'pageview');

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-55615382-1']);

	// set custom variables
	_gaq.push(['_setCustomVar',
      1,
      'Locale',
      'fr',
      3                    // Sets the scope to page-level.  Optional parameter.
   ]);

	// track page view
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>

<script>
!function(d,s,id){
	var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s); js.id=id;js.async=true;js.src="https://a248.e.akamai.net/secure.meetupstatic.com/s/script/541522619002077648/api/mu.btns.js?id=7mne7asu2b3mogbtcckibuio6d";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","mu-bootjs");
// put anchor snippet in post
//<a href="http://www.meetup.com/MaptimeAlpes/events/222341190/" data-event="222341190" class="mu-rsvp-btn">RSVP</a>
</script>
    </body>
</html>
